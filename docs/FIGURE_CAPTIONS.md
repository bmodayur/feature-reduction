# Figure Captions for ROC Analysis

**Purpose**: Publication-quality captions for figures generated by `compute_roc_after_rfe.py`

---

## Figure 1: Diagnostic Performance of the 20-Feature Bayesian Surprise Model (4-Panel)

**Figure 1. Receiver operating characteristic (ROC) analysis of the 20-feature Bayesian surprise model for early infant movement screening.** (**a**) ROC curve showing the trade-off between true positive rate (sensitivity) and false positive rate (1 − specificity) across all classification thresholds. The model achieves an area under the curve (AUC) of 0.902, indicating excellent discriminative ability between at-risk and typically-developing infants. The red star indicates the optimal operating point determined by Youden's J statistic (threshold = −0.336). The diagonal dashed line represents the performance of a random classifier (AUC = 0.5). (**b**) Sensitivity (green), specificity (red), and Youden's J index (blue dashed) as functions of the z-score classification threshold. Youden's J statistic, defined as J = sensitivity + specificity − 1, provides a threshold-independent measure of diagnostic effectiveness that equally weights the detection of true positives and true negatives. The maximum J value identifies the optimal threshold that jointly maximizes both metrics, with corresponding sensitivity of 92.1% and specificity of 77.5%. (**c**) Positive predictive value (PPV, purple) and negative predictive value (NPV, orange) across thresholds. Note: PPV and NPV are computed using the sample prevalence from cross-validation (41.2% at-risk), not population prevalence (~10%). At population prevalence, PPV would be substantially lower and NPV higher. (**d**) Summary statistics and threshold selection guide showing confusion matrix elements and diagnostic metrics at clinically relevant operating points. The model was evaluated using 10-fold stratified cross-validation on 146 infants, with z-scores computed from Bayesian surprise analysis of 20 kinematic features (19 movement features plus age in weeks) selected via Enhanced Adaptive RFE.

---

## Figure 2: Impact of Feature Transformation on Discriminative Performance (Comparison Panel)

**Figure 2. Comparison of ROC performance between baseline and inverse-transformed feature representations.** ROC curves for the 20-feature Bayesian surprise model computed with baseline features (red, AUC = 0.847) versus features transformed using the bidirectional mapping f(x) = 1/(1 + |x|) applied to velocity and acceleration measurements (blue, AUC = 0.902). The inverse transformation addresses a fundamental limitation of the baseline Bayesian surprise approach: standard z-score computation assumes deviations from the normative mean indicate atypicality regardless of direction, which fails to capture bidirectional movement anomalies. For kinematic features such as movement velocity and acceleration, both abnormally low values (hypokinesia) and abnormally high values (hyperkinesia) may indicate developmental concerns. The transformation maps both extremes to values near zero, producing elevated surprise scores for either direction of deviation. This improved specificity from 61.0% to 77.5% (+16.5 percentage points) at matched sensitivity (92.1%), reducing the false positive rate from 39.0% to 22.5%. Stars indicate optimal operating points determined by Youden's J statistic. The transformation was applied to 11 features: 7 velocity features and 4 acceleration features identified as bidirectional markers.

---

## Figure 3: Z-Score Distributions by Risk Group (zscore_distribution_comparison.png)

**Figure 3. Bayesian surprise z-score distributions for typically-developing and at-risk infants, comparing baseline versus inverse-transformed features.** Side-by-side half-violin plots with overlaid individual observations (swarm plots) illustrating the separation between risk groups achieved by the 20-feature Bayesian surprise model. (**Left panel**) Baseline feature representation without transformation. Typically-developing infants (green, n = 20 per fold) show z-scores centered near the normative mean (μ ≈ −0.15, σ ≈ 0.87), while at-risk infants (red, n = 14 per fold) exhibit elevated surprise scores (μ ≈ 0.85, σ ≈ 1.12), reflecting deviation from typical movement patterns. The mean separation between groups (Δ ≈ 1.00) corresponds to an AUC of 0.847. (**Right panel**) Features transformed using the bidirectional mapping f(x) = 1/(1 + |x|) applied to velocity and acceleration measurements. The transformation increases the mean separation to Δ ≈ 1.26, corresponding to an improved AUC of 0.902. Diamond markers indicate group means; error bars represent ± 1 standard deviation. The enhanced separation with transformation reflects improved detection of bidirectional movement anomalies—both hypokinetic (reduced movement amplitude/velocity) and hyperkinetic (excessive movement) patterns—which the baseline model fails to distinguish from typical variation. Individual data points represent z-scores aggregated across 10-fold stratified cross-validation, with each infant appearing once per fold in which they were held out for testing.

---

## Figure 4: Feature Transformation Analysis (transformation_analysis.png)

**Figure 4. Mathematical analysis of the bidirectional feature transformation f(x) = 1/(1+|x|) across kinematic feature scales.** (**A**) The transformation function maps values across four orders of magnitude—from linear velocity features (mean ≈ 0.2 units) to angular acceleration features (mean ≈ 170 deg/s²)—into the bounded range (0, 1]. Markers indicate typical values for each feature type, with transformed values shown (e.g., linear velocity: f(0.2) = 0.83; angular acceleration: f(170) = 0.006). (**B**) Transformation sensitivity |f'(x)| = 1/(1+|x|)² plotted on log-log axes, demonstrating that sensitivity decreases with feature magnitude. Linear velocity features (x ≈ 0.2) retain high sensitivity (~0.69), while angular acceleration features (x ≈ 170) have very low sensitivity (~3×10⁻⁵). This scale-dependent sensitivity means the transformation has negligible effect on large-magnitude features but substantially compresses small-magnitude features. (**C**) Transformed value ranges for each feature type, showing mean ± 1 SD intervals. Linear features (velocity, acceleration) occupy the upper range (0.3–0.9), while angular features cluster near zero (< 0.1). The asymmetric compression ensures that deviations in linear features dominate the transformed surprise scores. (**D**) Comparison of z-scores for simulated hypokinesia (2 SD below mean) versus hyperkinesia (2 SD above mean) under baseline and transformed conditions. The transformation amplifies hypokinesia detection (z = −3.78 vs baseline −2.02) while attenuating hyperkinesia (z = −1.76 vs baseline −2.02), reflecting the derivative's larger magnitude at lower feature values. This asymmetry explains the transformation's primary clinical utility: improved detection of reduced movement amplitude characteristic of hypotonic developmental disorders.

---

## Technical Notes

### Youden's J Statistic

Youden's J statistic (also known as Youden's index or informedness) is defined as:

**J = sensitivity + specificity − 1 = TPR − FPR**

where TPR is the true positive rate and FPR is the false positive rate. The statistic ranges from 0 (no discriminative ability, equivalent to random classification) to 1 (perfect discrimination). Maximizing J identifies the threshold that optimally balances the detection of true positives (at-risk infants correctly identified) and true negatives (typical infants correctly ruled out). Unlike metrics such as accuracy, Youden's J is prevalence-independent and provides equal weight to sensitivity and specificity, making it appropriate for screening applications where the costs of false negatives (missed at-risk infants) and false positives (unnecessary referrals) should be balanced.

### Confidence Intervals

Sensitivity and specificity point estimates are accompanied by 95% Wilson score confidence intervals, which provide better coverage than the Wald interval for proportions near 0 or 1. For the 20-feature model at the Youden-optimal threshold:
- Sensitivity: 92.1% (95% CI: 86.5%–95.6%)
- Specificity: 77.5% (95% CI: 71.2%–82.7%)

### Cross-Validation Methodology

All metrics were computed using 10-fold stratified cross-validation to ensure robust performance estimates. Stratification preserved the ratio of at-risk to typical infants in each fold, preventing estimation bias due to class imbalance. The reported confusion matrix elements (TP = 129, FP = 45, FN = 11, TN = 155) represent aggregated counts across all 10 test folds, providing effective sample sizes of 140 at-risk observations and 200 typical observations.

### Feature Transformation Formula

The bidirectional transformation is defined as:

**x' = 1 / (1 + |x|)**

This monotonically decreasing function maps:
- Large positive values → small positive values (approaching 0)
- Large negative values → small positive values (approaching 0)
- Values near zero → values near 1

When these transformed features are standardized against a normative reference distribution (typical infants), both hyperkinetic and hypokinetic movement patterns produce elevated surprise scores, enabling detection of bidirectional anomalies that the baseline model would miss.

---

**Last Updated**: December 2025
**Script Source**: `scripts/compute_roc_after_rfe.py`

